FROM node:14.17-alpine3.13 

# NODE_ENV=production will not install devDependencies
ENV NODE_ENV=test

WORKDIR /work

# First copy over package.json and other lock files if any to ensure that we dont run dependencies for every change made within out business logic files
COPY package.json package-lock.json* yarn.lock* npm-shrinkwrap.json* ./

RUN yarn


ENV PORT ${NODE_APP_CONTAINER_NAME_PORT}

# This does not actually expose anything, its only meant for reference purpose
EXPOSE $PORT

# WHen you start container this command will get executed
# You can override this during runtime if you want
CMD ["yarn", "test"]